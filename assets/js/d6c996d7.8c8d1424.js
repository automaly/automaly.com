"use strict";(self.webpackChunkautomaly_com=self.webpackChunkautomaly_com||[]).push([[9342],{34885:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>s,metadata:()=>d,toc:()=>l});var n=t(85893),o=t(11151);const s={date:"2024-01-07",title:"Throw behaviour in X++",categories:["X++"],tags:["throw","error"],authors:"kome"},i=void 0,d={permalink:"/blog/2024/01/07/ThrowBehaviour",source:"@site/blog/2024-01-07-ThrowBehaviour/index.md",title:"Throw behaviour in X++",description:"References",date:"2024-01-07T00:00:00.000Z",formattedDate:"January 7, 2024",tags:[{label:"throw",permalink:"/blog/tags/throw"},{label:"error",permalink:"/blog/tags/error"}],readingTime:2.3866666666666667,hasTruncateMarker:!0,authors:[{name:"Kome Hoang",title:"Maintainer of Automaly",url:"https://www.linkedin.com/in/khahgm7",imageURL:"https://media.licdn.com/dms/image/C4D03AQGuOEU77XCmdQ/profile-displayphoto-shrink_100_100/0/1655606217720?e=1705536000&v=beta&t=Gy-ufD6rZD24efoO8WIcAxA4KARuXj036gZ1tdeOW24",key:"kome"}],frontMatter:{date:"2024-01-07",title:"Throw behaviour in X++",categories:["X++"],tags:["throw","error"],authors:"kome"},unlisted:!1,nextItem:{title:"Using XppPrePostArgs to pass parameters through a method",permalink:"/blog/2024/01/02/TrickXppPrePostArg"}},c={authorsImageUrls:[void 0]},l=[{value:"References",id:"references",level:2},{value:"How to",id:"how-to",level:2},{value:"Prerequisite",id:"prerequisite",level:3},{value:"Let&#39;s do it",id:"lets-do-it",level:3},{value:"When we don&#39;t use <code>throw</code>",id:"when-we-dont-use-throw",level:3},{value:"When we use <code>throw</code>",id:"when-we-use-throw",level:3}];function a(e){const r={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.h2,{id:"references",children:"References"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:(0,n.jsx)(r.a,{href:"https://learn.microsoft.com/en-us/dynamics365/fin-ops-core/dev-itpro/dev-ref/xpp-exceptions",children:"X++ exception handling"})}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"how-to",children:"How to"}),"\n",(0,n.jsx)(r.h3,{id:"prerequisite",children:"Prerequisite"}),"\n",(0,n.jsxs)(r.p,{children:["For the purpose of testing, I had this data set of CustGroup. This can also be found on Legal Entity ",(0,n.jsx)(r.code,{children:"USRT"})," of demo data comes with a new environment of Dynamics 365 Finance."]}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Customer group"}),(0,n.jsx)(r.th,{children:"Description"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"10"}),(0,n.jsx)(r.td,{children:"Wholesale customers"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"20"}),(0,n.jsx)(r.td,{children:"Major customers"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"30"}),(0,n.jsx)(r.td,{children:"Retail customers"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"40"}),(0,n.jsx)(r.td,{children:"Internet customers"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"50"}),(0,n.jsx)(r.td,{children:"Employees"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"80"}),(0,n.jsx)(r.td,{children:"Wholesale customers"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"90"}),(0,n.jsx)(r.td,{children:"Wholesale customers"})]})]})]}),"\n",(0,n.jsxs)(r.p,{children:["I added two new buttons on ",(0,n.jsx)(r.code,{children:"CustGroup"})," form:"]}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"Bulk update Desc"}),": This button will loop through each and all records in the above table and update the Description to Description + ",(0,n.jsx)(r.code,{children:"+ Updated"}),' except one containing "Employee". They will become like below.']}),"\n"]}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Customer group"}),(0,n.jsx)(r.th,{children:"Description"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"10"}),(0,n.jsx)(r.td,{children:"Wholesale customers + Updated"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"20"}),(0,n.jsx)(r.td,{children:"Major customers + Updated"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"30"}),(0,n.jsx)(r.td,{children:"Retail customers + Updated"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"40"}),(0,n.jsx)(r.td,{children:"Internet customers + Updated"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"50"}),(0,n.jsx)(r.td,{children:"Employees"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"80"}),(0,n.jsx)(r.td,{children:"Wholesale customers + Updated"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"90"}),(0,n.jsx)(r.td,{children:"Wholesale customers + Updated"})]})]})]}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"Reverse Bulk update Desc"}),": This button will update all Description back to its original by removing the word ",(0,n.jsx)(r.code,{children:"+ Updated"}),"."]}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"lets-do-it",children:"Let's do it"}),"\n",(0,n.jsxs)(r.h3,{id:"when-we-dont-use-throw",children:["When we don't use ",(0,n.jsx)(r.code,{children:"throw"})]}),"\n",(0,n.jsxs)(r.p,{children:["In the extension class named ",(0,n.jsx)(r.code,{children:"CustGroup_ButtonHandlers"}),", I put these codes which will handle the event of clicking those two buttons."]}),"\n",(0,n.jsx)(r.admonition,{type:"tip",children:(0,n.jsxs)(r.p,{children:["This type of ",(0,n.jsx)(r.code,{children:"FormControlEventHandler"})," will only be needed when you are extending a standard form. For a totally custom form, you can add a ",(0,n.jsx)(r.a,{href:"https://learn.microsoft.com/en-us/dotnet/api/dynamics.ax.application.formbuttoncontrol.clicked",children:"Clicked() method"})," method for any buttons on the form."]})}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-cs",children:'internal final class CustGroup_ButtonHandlers\r\n{\r\n    [FormControlEventHandler(formControlStr(CustGroup, BulkUpdateDesc), FormControlEventType::Clicked)]\r\n    public static void BulkUpdateDesc_OnClicked(FormControl sender, FormControlEventArgs e)\r\n    {\r\n        FormDataSource custGroupDS = sender.formRun().dataSource(formDataSourceStr(CustGroup, CustGroup));\r\n        \r\n        ttsbegin;\r\n\r\n        for(\r\n            CustGroup custGroup =\r\n                custGroupDS.getFirst() ?\r\n                custGroupDS.getFirst() :\r\n                custGroupDS.cursor()\r\n            ; custGroup\r\n            ; custGroup = custGroupDS.getNext()\r\n        )\r\n        {\r\n            if(strContains(custGroup.Name, "Employees"))\r\n            {\r\n                // Show an error here but do not stop the loop\r\n                error("This group\'s name contains \\"Employees\\". Operation skipped but continue until the end of loop.");\r\n\r\n                // Continue the loop by (1) skipping below code and (2) getting the next record from the DS\r\n                continue;\r\n            }\r\n\r\n            custGroup.Name = custGroup.Name + " + Updated";\r\n            custGroup.doUpdate();\r\n        }\r\n\r\n        ttscommit;\r\n\r\n        custGroupDS.research(true);\r\n    }\r\n    \r\n    [FormControlEventHandler(formControlStr(CustGroup, BulkRevUpdateDesc), FormControlEventType::Clicked)]\r\n    public static void BulkRevUpdateDesc_OnClicked(FormControl sender, FormControlEventArgs e)\r\n    {\r\n        FormDataSource custGroupDS = sender.formRun().dataSource(formDataSourceStr(CustGroup, CustGroup));\r\n\r\n        ttsbegin;\r\n\r\n        for(\r\n            CustGroup custGroup =\r\n                custGroupDS.getFirst() ?\r\n                custGroupDS.getFirst() :\r\n                custGroupDS.cursor()\r\n            ; custGroup\r\n            ; custGroup = custGroupDS.getNext()\r\n        )\r\n        {\r\n            custGroup.Name = strReplace(custGroup.Name, " + Updated", "");\r\n            custGroup.doUpdate();\r\n        }\r\n\r\n        ttscommit;\r\n\r\n        custGroupDS.research(true);\r\n    }\r\n}\n'})}),"\n",(0,n.jsx)(r.p,{children:"Notice the part"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-cs",children:'if(strContains(custGroup.Name, "Employees"))\r\n{\r\n    // Show an error here but do not stop the loop\r\n    error("This group\'s name contains \\"Employees\\". Operation skipped but continue until the end of loop.");\r\n\r\n    // Continue the loop by (1) skipping below code and (2) getting the next record from the DS\r\n    continue;\r\n}\n'})}),"\n",(0,n.jsxs)(r.p,{children:["This part will do the job of updating the Description of the CustGroup record. Yet, I am calling ",(0,n.jsx)(r.code,{children:"error"}),' to display a message (which is speicifed as an "error") to users.']}),"\n",(0,n.jsxs)(r.p,{children:["Now, let's click the ",(0,n.jsx)(r.code,{children:"Bulk update Desc"})," button. You will see the error message and the updated description. We can tell that the loop was not stopped."]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"alt text",src:t(89024).Z+"",width:"686",height:"369"})}),"\n",(0,n.jsxs)(r.h3,{id:"when-we-use-throw",children:["When we use ",(0,n.jsx)(r.code,{children:"throw"})]}),"\n",(0,n.jsxs)(r.p,{children:["Let's change the part mentioned above to this one. Notice that we now will use ",(0,n.jsx)(r.code,{children:"throw"})," before ",(0,n.jsx)(r.code,{children:"error"}),"."]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-cs",children:'if(strContains(custGroup.Name, "Employees"))\r\n{\r\n    // Show an error here and break the loop\r\n    throw error("This group\'s name contains \\"Employees\\". Operation broken.");\r\n\r\n    // Below code line is actually never called because the throw will stop the code execution immediately\r\n    continue;\r\n}\n'})}),"\n",(0,n.jsxs)(r.p,{children:["Clicking ",(0,n.jsx)(r.code,{children:"Bulk update Desc"})," will result in this."]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"alt text",src:t(94790).Z+"",width:"799",height:"379"})}),"\n",(0,n.jsxs)(r.p,{children:["Yet, upon refreshing the form, we will see that no transaction within the same ",(0,n.jsx)(r.code,{children:"tts"})," level was actually committed."]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"alt text",src:t(47314).Z+"",width:"802",height:"380"})}),"\n",(0,n.jsxs)(r.p,{children:["Now if we bring the ",(0,n.jsx)(r.code,{children:"tts"})," inside the loop."]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-cs",children:'{\r\n    if(strContains(custGroup.Name, "Employees"))\r\n    {\r\n        // Show an error here and break the loop\r\n        throw error("This group\'s name contains \\"Employees\\". Operation broken.");\r\n\r\n        // Below code line is actually never called because the throw will stop the code execution immediately\r\n        continue;\r\n    }\r\n\r\n    ttsbegin;\r\n\r\n    custGroup.Name = custGroup.Name + " + Updated";\r\n    custGroup.doUpdate();\r\n\r\n    ttscommit;\r\n}\n'})}),"\n",(0,n.jsx)(r.p,{children:"Upop refreshing the form, we will see what transaction were commited and what part of the loop was broken."}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"alt text",src:t(34570).Z+"",width:"793",height:"371"})}),"\n",(0,n.jsxs)(r.p,{children:["So, that's how ",(0,n.jsx)(r.code,{children:"throw"})," works in X++."]})]})}function h(e={}){const{wrapper:r}={...(0,o.a)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(a,{...e})}):a(e)}},94790:(e,r,t)=>{t.d(r,{Z:()=>n});const n=t.p+"assets/images/image-1-209c0bb4db028b19e6b9d77a0e477efe.png"},47314:(e,r,t)=>{t.d(r,{Z:()=>n});const n=t.p+"assets/images/image-2-9b99948692ef5fe69b8ef8707b68ac34.png"},34570:(e,r,t)=>{t.d(r,{Z:()=>n});const n=t.p+"assets/images/image-3-ce59dc84f39ef376679d2cfcd822eaad.png"},89024:(e,r,t)=>{t.d(r,{Z:()=>n});const n=t.p+"assets/images/image-a63ff1cd1928ab2665c5316fb58c5a99.png"},11151:(e,r,t)=>{t.d(r,{Z:()=>d,a:()=>i});var n=t(67294);const o={},s=n.createContext(o);function i(e){const r=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function d(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),n.createElement(s.Provider,{value:r},e.children)}}}]);