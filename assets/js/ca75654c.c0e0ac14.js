"use strict";(self.webpackChunkautomaly_test=self.webpackChunkautomaly_test||[]).push([[5699],{15807:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>s,contentTitle:()=>a,default:()=>d,frontMatter:()=>l,metadata:()=>m,toc:()=>i});var r=o(74848),n=o(28453);const l={date:"2021-12-23",title:"Send multiple records to workflow",categories:["X++","Workflow"],tags:["Workflow"],authors:"max",unlisted:!0},a=void 0,m={permalink:"/blog/2021/12/23/Dynamics-365-Finance-Operations-Send-multiple-records-to-workflow",source:"@site/blog/2021-12-23-Dynamics-365-Finance-Operations-Send-multiple-records-to-workflow/index.md",title:"Send multiple records to workflow",description:"How to send multiple records to workflow using X++ in Dynamics 365 Finance Operations",date:"2021-12-23T00:00:00.000Z",tags:[{inline:!0,label:"Workflow",permalink:"/blog/tags/workflow"}],readingTime:.8866666666666667,hasTruncateMarker:!1,authors:[{name:"Max Nguyen",title:"FinOps Ranger",url:"/about",imageURL:"https://github.com/Dynamics365.png",key:"max"}],frontMatter:{date:"2021-12-23",title:"Send multiple records to workflow",categories:["X++","Workflow"],tags:["Workflow"],authors:"max",unlisted:!0},unlisted:!0},s={authorsImageUrls:[void 0]},i=[];function c(e){const t={code:"code",img:"img",p:"p",pre:"pre",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.p,{children:"How to send multiple records to workflow using X++ in Dynamics 365 Finance Operations"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-csharp",metastring:'showLineNumbers title="Submit Code"',children:"#define.WorkFlowTemplateName(\"Template Name\")  \r\n// or -- workFlowTypeStr(Template name)\r\n\r\nif (common.WorkflowApprovalStatus == WFApprovalStatus::Draft)\r\n{\r\n    Workflow::activateFromWorkflowType(#WorkFlowTemplateName, common.RecId, \r\n\t                                'Workflow submitted by button', false, Curuserid());\r\n}\n"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-csharp",metastring:'showLineNumbers title="Approval Code"',children:'WorkflowWorkItemTable   WorkflowWorkItemTable;\r\n\r\n// main code\r\nselect firstonly WorkflowWorkItemTable\r\n    where workflowWorkItemTable.Type == WorkflowWorkItemType::WorkItem\r\n\t&& workflowWorkItemTable.Status == WorkflowWorkItemStatus::Pending // this should be Pending\r\n\t&& WorkflowWorkItemTable.RefTableId == tableNum(common)\r\n\t&& WorkflowWorkItemTable.RefRecId  == common.RecId;\r\n\r\nif (WorkflowWorkItemTable)\r\n{\r\n    WorkflowWorkItemActionManager::dispatchWorkItemAction(WorkflowWorkItemTable,\r\n\t\t\t\t\t\t\t"Mulitple Approve by button", \r\n\t\t\t\t\t\t\tcuruserId(), \r\n                                                        WorkflowWorkItemActionType::Complete,\r\n\t\t\t\t\t\t\tmenuitemActionStr("Approve menu item name"));\r\n}\n'})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-csharp",metastring:'showLineNumbers title="Reject Code"',children:"WorkflowWorkItemTable   WorkflowWorkItemTable;\r\n\r\n// main code\r\nselect WorkflowWorkItemTable\r\n    where workflowWorkItemTable.Type == WorkflowWorkItemType::WorkItem\r\n\t&& workflowWorkItemTable.Status == WorkflowWorkItemStatus::Pending\r\n\t&& WorkflowWorkItemTable.RefTableId == tableNum(Common)\r\n\t&& WorkflowWorkItemTable.RefRecId  == common.RecId;\r\n\r\nif (WorkflowWorkItemTable)\r\n{\r\n    ttsbegin;\r\n    WorkflowWorkItemActionManager::dispatchWorkItemAction(WorkflowWorkItemTable,\r\n\t\t\t\t\t\t\t    \"Mulitple Reject by button\", \r\n\t\t\t\t\t\t\t    curuserId(), \r\n\t\t\t\t\t\t\t    WorkflowWorkItemActionType::Return,\r\n\t\t\t\t\t\t\t    menuitemActionStr('Reject menu item Name'));\r\n    ttscommit;\r\n}\n"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-csharp",metastring:'showLineNumbers title="Recall Code"',children:'#define.WorkFlowTemplateName("Template Name")  \r\n// or -- workFlowTypeStr(Template name)\r\n\r\nif (common.WorkflowApprovalStatus == WFApprovalStatus::Submitted \r\n    || common.WorkflowApprovalStatus == WFApprovalStatus::PendingApproval)\r\n{\r\n    WorkflowCorrelationId\tworkflowCorrelationId = Workflow::activateFromWorkflowType(#WorkFlowTemplateName, \r\n\t\t\t\t\t\t\t\t\t\t\t    common.RecId, \r\n                                                                                            \'By button RecallAllToWorkflow\', \r\n\t\t\t\t\t\t\t\t\t\t\t    true, Curuserid());\r\n   \r\n    Workflow::cancelWorkflow(workflowCorrelationId,"Mulitple Recalled by user");\r\n}\n'})}),"\n",(0,r.jsx)(t.p,{children:"Button Clicked method Code: For multi-select, we need to loop the record by record so for that I have used the button clicked. Instead of this, we can create a new class and write in the main method."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-csharp",metastring:'showLineNumbers title="Recall Code"',children:"void clicked()\r\n{   \r\n    FormDataSource      Common_ds = element.Common_ds;\r\n    Common    \t       common    = Common_ds.cursor(); \r\n    System.Exception    ex;\r\n\r\n    next clicked();      \r\n\r\n    if (Common_ds.Anymarked())\r\n    {\r\n        for (common = getFirstSelection(Common_ds); common; common = Common_ds.getNext())\r\n\t{\r\n\t    try\r\n\t    {\r\n\t        // call the Approve or submit or Reject code \r\n\t    }    \r\n\t    catch\r\n\t    {\r\n\t\tex = CLRInterop::getLastException().GetBaseException();\r\n\t\terror(ex.get_Message());\r\n\t    }\r\n\t}\r\n    }\r\n\t\r\n    Common_ds.research(true);\r\n}\n"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Set button properties",src:o(95925).A+"",width:"1178",height:"351"})})]})}function d(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},95925:(e,t,o)=>{o.d(t,{A:()=>r});const r=o.p+"assets/images/image_2023_09_12T12_01_42_192Z-aba96cf601c3fbc0a409f3ffb283d6dc.png"},28453:(e,t,o)=>{o.d(t,{R:()=>a,x:()=>m});var r=o(96540);const n={},l=r.createContext(n);function a(e){const t=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function m(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),r.createElement(l.Provider,{value:t},e.children)}}}]);